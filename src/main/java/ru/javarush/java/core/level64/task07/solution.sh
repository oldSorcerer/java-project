#!/usr/bin/env bash
# Скрипт демонстрирует снятие полного дампа памяти работающего Java-приложения с помощью jmap.
# Пример команды (важно указать правильный PID процесса Java):
#   jmap -dump:format=b,file=heap.bin <PID>

set -e

# 1) Компиляция простого Java-приложения
javac Solution.java

# 2) Запуск приложения в фоне и сохранение PID процесса "java"
java Solution &
APP_PID=$!

# На случай ошибки/выхода — корректно останавливаем запущенное приложение


# Дадим JVM стартовать, чтобы jmap смог к ней подключиться


# Для наглядности покажем список Java-процессов (можно сверить PID через jps)
# Если jps отсутствует — команда ничего не сломает


# 3) Снятие дампа памяти. Файл heap.bin появится в текущей директории.
# Пример ручного вызова:
#   jmap -dump:format=b,file=heap.bin <PID>


# 4) Останавливаем приложение (trap на EXIT продублирует завершение на всякий случай)