
### –ù–∞–≤–∏–≥–∞—Ç–æ—Ä –î—Ä–æ–Ω–∞: –û–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω—ã–π –†–∞—Å—á—ë—Ç –ü–æ–∑–∏—Ü–∏–∏ üöÅ

–í—ã ‚Äî –≥–ª–∞–≤–Ω—ã–π –∏–Ω–∂–µ–Ω–µ—Ä, –æ—Ç–≤–µ—á–∞—é—â–∏–π –∑–∞ —Ç–æ—á–Ω–æ—Å—Ç—å –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –¥—Ä–æ–Ω–∞-—Ä–∞–∑–≤–µ–¥—á–∏–∫–∞. –î—Ä–æ–Ω –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –ø–µ—Ä–µ–¥–∞–µ—Ç —Å–≤–æ–∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã (x, y), –∫–æ—Ç–æ—Ä—ã–µ –º–≥–Ω–æ–≤–µ–Ω–Ω–æ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è. –í–∞—à–∞ –∑–∞–¥–∞—á–∞ ‚Äî —Å–æ–∑–¥–∞—Ç—å —Å–∏—Å—Ç–µ–º—É, –∫–æ—Ç–æ—Ä–∞—è –º–æ–∂–µ—Ç –æ—á–µ–Ω—å –±—ã—Å—Ç—Ä–æ –ø–æ–ª—É—á–∞—Ç—å —Å—É–º–º—É —ç—Ç–∏—Ö –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –¥–ª—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏—Ö —Ü–µ–ª–µ–π. –í –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–µ —Å–ª—É—á–∞–µ–≤, –∫–æ–≥–¥–∞ –≤—ã ¬´–±—Ä–æ—Å–∞–µ—Ç–µ –±—ã—Å—Ç—Ä—ã–π –≤–∑–≥–ª—è–¥¬ª –Ω–∞ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã, –æ–Ω–∏ —Å—Ç–∞–±–∏–ª—å–Ω—ã. –û–¥–Ω–∞–∫–æ –∏–Ω–æ–≥–¥–∞ –æ–Ω–∏ –º–æ–≥—É—Ç –∏–∑–º–µ–Ω–∏—Ç—å—Å—è –ø—Ä—è–º–æ –≤ –º–æ–º–µ–Ω—Ç —á—Ç–µ–Ω–∏—è, —á—Ç–æ –ø–æ—Ç—Ä–µ–±—É–µ—Ç –±–æ–ª–µ–µ –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ–≥–æ, –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ —Å—á–∏—Ç—ã–≤–∞–Ω–∏—è.

–†–∞–∑—Ä–∞–±–æ—Ç–∞–π—Ç–µ –∫–ª–∞—Å—Å DronePosition —Å –¥–≤—É–º—è –ø–æ–ª—è–º–∏ dronePositionX –∏ dronePositionY (—á–∏—Å–ª–∞ —Å –ø–ª–∞–≤–∞—é—â–µ–π —Ç–æ—á–∫–æ–π) –∏ –º–µ—Ö–∞–Ω–∏–∑–º–æ–º –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –Ω–∏–º. –†–µ–∞–ª–∏–∑—É–π—Ç–µ –º–µ—Ç–æ–¥ calculateTotalPosition(). –≠—Ç–æ—Ç –º–µ—Ç–æ–¥ –¥–æ–ª–∂–µ–Ω —Å–Ω–∞—á–∞–ª–∞ –ø—Ä–µ–¥–ø—Ä–∏–Ω—è—Ç—å –ø–æ–ø—ã—Ç–∫—É ¬´–æ–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω–æ–≥–æ¬ª —á—Ç–µ–Ω–∏—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç: –±—ã—Å—Ç—Ä–æ –ø–æ–ª—É—á–∏—Ç—å –∏—Ö –±–µ–∑ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏, –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞—è, —á—Ç–æ –æ–Ω–∏ –Ω–µ –∏–∑–º–µ–Ω—è—Ç—Å—è. –ó–∞—Ç–µ–º, –µ—Å–ª–∏ —Å–∏—Å—Ç–µ–º–∞ –æ–±–Ω–∞—Ä—É–∂–∏—Ç, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –±—ã–ª–∏ –∏–∑–º–µ–Ω–µ–Ω—ã –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ —Ç–∞–∫–æ–≥–æ –±—ã—Å—Ç—Ä–æ–≥–æ —á—Ç–µ–Ω–∏—è, –æ–Ω–∞ –¥–æ–ª–∂–Ω–∞ –≤–µ—Ä–Ω—É—Ç—å—Å—è –∏ –ø—Ä–æ—á–∏—Ç–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è –∑–∞–Ω–æ–≤–æ, –Ω–æ —É–∂–µ —Å –ø–æ–ª–Ω—ã–º –≤–Ω–∏–º–∞–Ω–∏–µ–º, –≤—Ä–µ–º–µ–Ω–Ω–æ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–≤ –¥–æ—Å—Ç—É–ø, —á—Ç–æ–±—ã –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–æ—á–Ω–æ—Å—Ç—å. –í –∫–æ–Ω—Ü–µ –º–µ—Ç–æ–¥ –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å —Å—É–º–º—É dronePositionX –∏ dronePositionY.

–í –≥–ª–∞–≤–Ω–æ–π —á–∞—Å—Ç–∏ –ø—Ä–æ–≥—Ä–∞–º–º—ã —Å–æ–∑–¥–∞–π—Ç–µ –æ–±—ä–µ–∫—Ç DronePosition —Å –Ω–∞—á–∞–ª—å–Ω—ã–º–∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏ 2.5 –¥–ª—è dronePositionX –∏ 3.7 –¥–ª—è dronePositionY. –í—ã–∑–æ–≤–∏—Ç–µ calculateTotalPosition() –∏ –≤—ã–≤–µ–¥–∏—Ç–µ –ø–æ–ª—É—á–µ–Ω–Ω—É—é —Å—É–º–º—É –Ω–∞ —ç–∫—Ä–∞–Ω. –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç ‚Äî 6.2, —á—Ç–æ –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç –±–µ–∑—É–ø—Ä–µ—á–Ω—É—é —Ä–∞–±–æ—Ç—É –≤–∞—à–µ–≥–æ –Ω–∞–≤–∏–≥–∞—Ç–æ—Ä–∞.

#### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:
1. –ö–ª–∞—Å—Å DronePosition –¥–æ–ª–∂–µ–Ω –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å StampedLock –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º.
2. –ö–ª–∞—Å—Å DronePosition –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –¥–≤–∞ –ø–æ–ª—è: dronePositionX –∏ dronePositionY —Ç–∏–ø–∞ double.
3. –ú–µ—Ç–æ–¥ calculateTotalPosition() –¥–æ–ª–∂–µ–Ω —Å–Ω–∞—á–∞–ª–∞ –ø–æ–ø—ã—Ç–∞—Ç—å—Å—è –ø—Ä–æ—á–∏—Ç–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç —Å –ø–æ–º–æ—â—å—é –æ–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω–æ–π –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ (tryOptimisticRead).
4. –ü–æ—Å–ª–µ —á—Ç–µ–Ω–∏—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, –Ω–µ –∏–∑–º–µ–Ω–∏–ª–∏—Å—å –ª–∏ –¥–∞–Ω–Ω—ã–µ –≤–æ –≤—Ä–µ–º—è —á—Ç–µ–Ω–∏—è —Å –ø–æ–º–æ—â—å—é –º–µ—Ç–æ–¥–∞ validate().
5. –ï—Å–ª–∏ –æ–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω–æ–µ —á—Ç–µ–Ω–∏–µ –æ–∫–∞–∑–∞–ª–æ—Å—å –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–º, –º–µ—Ç–æ–¥ calculateTotalPosition() –¥–æ–ª–∂–µ–Ω –ø–æ–≤—Ç–æ—Ä–∏—Ç—å —á—Ç–µ–Ω–∏–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç —Å –∑–∞—Ö–≤–∞—Ç–æ–º read-–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ (readLock).
6. –ú–µ—Ç–æ–¥ calculateTotalPosition() –¥–æ–ª–∂–µ–Ω –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å —Å—É–º–º—É dronePositionX –∏ dronePositionY.
7. –í –æ—Å–Ω–æ–≤–Ω–æ–π —á–∞—Å—Ç–∏ –ø—Ä–æ–≥—Ä–∞–º–º—ã –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Å–æ–∑–¥–∞–Ω –æ–±—ä–µ–∫—Ç DronePosition —Å –Ω–∞—á–∞–ª—å–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ 2.5 –¥–ª—è dronePositionX –∏ 3.7 –¥–ª—è dronePositionY.
8. –ü–æ—Å–ª–µ –≤—ã–∑–æ–≤–∞ calculateTotalPosition() —Ä–µ–∑—É–ª—å—Ç–∞—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤—ã–≤–µ–¥–µ–Ω –Ω–∞ —ç–∫—Ä–∞–Ω, –∏ –æ–Ω –¥–æ–ª–∂–µ–Ω —Ä–∞–≤–Ω—è—Ç—å—Å—è 6.2.